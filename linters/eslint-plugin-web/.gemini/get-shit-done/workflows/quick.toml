prompt = "<purpose>\nExecute small, ad-hoc tasks with GSD guarantees (atomic commits, STATE.md tracking) while skipping optional agents (research, plan-checker, verifier). Quick mode spawns gsd-planner (quick mode) + gsd-executor(s), tracks tasks in `.planning/quick/`, and updates STATE.md's \"Quick Tasks Completed\" table.\n</purpose>\n\n<required_reading>\nRead all files referenced by the invoking prompt's execution_context before starting.\n</required_reading>\n\n<process>\n**Step 1: Get task description**\n\nPrompt user interactively for the task description:\n\n```\nAskUserQuestion(\n  header: \"Quick Task\",\n  question: \"What do you want to do?\",\n  followUp: null\n)\n```\n\nStore response as `$DESCRIPTION`.\n\nIf empty, re-prompt: \"Please provide a task description.\"\n\n---\n\n**Step 2: Initialize**\n\n```bash\nINIT=$(node ./.gemini/get-shit-done/bin/gsd-tools.js init quick \"$DESCRIPTION\")\n```\n\nParse JSON for: `planner_model`, `executor_model`, `commit_docs`, `next_num`, `slug`, `date`, `timestamp`, `quick_dir`, `task_dir`, `roadmap_exists`, `planning_exists`.\n\n**If `roadmap_exists` is false:** Error — Quick mode requires an active project with ROADMAP.md. Run `/gsd:new-project` first.\n\nQuick tasks can run mid-phase - validation only checks ROADMAP.md exists, not phase status.\n\n---\n\n**Step 3: Create task directory**\n\n```bash\nmkdir -p \"${task_dir}\"\n```\n\n---\n\n**Step 4: Create quick task directory**\n\nCreate the directory for this quick task:\n\n```bash\nQUICK_DIR=\".planning/quick/${next_num}-${slug}\"\nmkdir -p \"$QUICK_DIR\"\n```\n\nReport to user:\n```\nCreating quick task ${next_num}: ${DESCRIPTION}\nDirectory: ${QUICK_DIR}\n```\n\nStore `$QUICK_DIR` for use in orchestration.\n\n---\n\n**Step 5: Spawn planner (quick mode)**\n\nSpawn gsd-planner with quick mode context:\n\n```\nTask(\n  prompt=\"\n<planning_context>\n\n**Mode:** quick\n**Directory:** ${QUICK_DIR}\n**Description:** ${DESCRIPTION}\n\n**Project State:**\n@.planning/STATE.md\n\n</planning_context>\n\n<constraints>\n- Create a SINGLE plan with 1-3 focused tasks\n- Quick tasks should be atomic and self-contained\n- No research phase, no checker phase\n- Target ~30% context usage (simple, focused)\n</constraints>\n\n<output>\nWrite plan to: ${QUICK_DIR}/${next_num}-PLAN.md\nReturn: ## PLANNING COMPLETE with plan path\n</output>\n\",\n  subagent_type=\"gsd-planner\",\n  model=\"{planner_model}\",\n  description=\"Quick plan: ${DESCRIPTION}\"\n)\n```\n\nAfter planner returns:\n1. Verify plan exists at `${QUICK_DIR}/${next_num}-PLAN.md`\n2. Extract plan count (typically 1 for quick tasks)\n3. Report: \"Plan created: ${QUICK_DIR}/${next_num}-PLAN.md\"\n\nIf plan not found, error: \"Planner failed to create ${next_num}-PLAN.md\"\n\n---\n\n**Step 6: Spawn executor**\n\nSpawn gsd-executor with plan reference:\n\n```\nTask(\n  prompt=\"\nExecute quick task ${next_num}.\n\nPlan: @${QUICK_DIR}/${next_num}-PLAN.md\nProject state: @.planning/STATE.md\n\n<constraints>\n- Execute all tasks in the plan\n- Commit each task atomically\n- Create summary at: ${QUICK_DIR}/${next_num}-SUMMARY.md\n- Do NOT update ROADMAP.md (quick tasks are separate from planned phases)\n</constraints>\n\",\n  subagent_type=\"gsd-executor\",\n  model=\"{executor_model}\",\n  description=\"Execute: ${DESCRIPTION}\"\n)\n```\n\nAfter executor returns:\n1. Verify summary exists at `${QUICK_DIR}/${next_num}-SUMMARY.md`\n2. Extract commit hash from executor output\n3. Report completion status\n\n**Known Claude Code bug (classifyHandoffIfNeeded):** If executor reports \"failed\" with error `classifyHandoffIfNeeded is not defined`, this is a Claude Code runtime bug — not a real failure. Check if summary file exists and git log shows commits. If so, treat as successful.\n\nIf summary not found, error: \"Executor failed to create ${next_num}-SUMMARY.md\"\n\nNote: For quick tasks producing multiple plans (rare), spawn executors in parallel waves per execute-phase patterns.\n\n---\n\n**Step 7: Update STATE.md**\n\nUpdate STATE.md with quick task completion record.\n\n**7a. Check if \"Quick Tasks Completed\" section exists:**\n\nRead STATE.md and check for `### Quick Tasks Completed` section.\n\n**7b. If section doesn't exist, create it:**\n\nInsert after `### Blockers/Concerns` section:\n\n```markdown\n### Quick Tasks Completed\n\n| # | Description | Date | Commit | Directory |\n|---|-------------|------|--------|-----------|\n```\n\n**7c. Append new row to table:**\n\nUse `date` from init:\n```markdown\n| ${next_num} | ${DESCRIPTION} | ${date} | ${commit_hash} | [${next_num}-${slug}](./quick/${next_num}-${slug}/) |\n```\n\n**7d. Update \"Last activity\" line:**\n\nUse `date` from init:\n```\nLast activity: ${date} - Completed quick task ${next_num}: ${DESCRIPTION}\n```\n\nUse Edit tool to make these changes atomically\n\n---\n\n**Step 8: Final commit and completion**\n\nStage and commit quick task artifacts:\n\n```bash\nnode ./.gemini/get-shit-done/bin/gsd-tools.js commit \"docs(quick-${next_num}): ${DESCRIPTION}\" --files ${QUICK_DIR}/${next_num}-PLAN.md ${QUICK_DIR}/${next_num}-SUMMARY.md .planning/STATE.md\n```\n\nGet final commit hash:\n```bash\ncommit_hash=$(git rev-parse --short HEAD)\n```\n\nDisplay completion output:\n```\n---\n\nGSD > QUICK TASK COMPLETE\n\nQuick Task ${next_num}: ${DESCRIPTION}\n\nSummary: ${QUICK_DIR}/${next_num}-SUMMARY.md\nCommit: ${commit_hash}\n\n---\n\nReady for next task: /gsd:quick\n```\n\n</process>\n\n<success_criteria>\n- [ ] ROADMAP.md validation passes\n- [ ] User provides task description\n- [ ] Slug generated (lowercase, hyphens, max 40 chars)\n- [ ] Next number calculated (001, 002, 003...)\n- [ ] Directory created at `.planning/quick/NNN-slug/`\n- [ ] `${next_num}-PLAN.md` created by planner\n- [ ] `${next_num}-SUMMARY.md` created by executor\n- [ ] STATE.md updated with quick task row\n- [ ] Artifacts committed\n</success_criteria>\n"
