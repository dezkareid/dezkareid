prompt = "# Planner Subagent Prompt Template\n\nTemplate for spawning gsd-planner agent. The agent contains all planning expertise - this template provides planning context only.\n\n---\n\n## Template\n\n```markdown\n<planning_context>\n\n**Phase:** {phase_number}\n**Mode:** {standard | gap_closure}\n\n**Project State:**\n@.planning/STATE.md\n\n**Roadmap:**\n@.planning/ROADMAP.md\n\n**Requirements (if exists):**\n@.planning/REQUIREMENTS.md\n\n**Phase Context (if exists):**\n@.planning/phases/{phase_dir}/{phase}-CONTEXT.md\n\n**Research (if exists):**\n@.planning/phases/{phase_dir}/{phase}-RESEARCH.md\n\n**Gap Closure (if --gaps mode):**\n@.planning/phases/{phase_dir}/{phase}-VERIFICATION.md\n@.planning/phases/{phase_dir}/{phase}-UAT.md\n\n</planning_context>\n\n<downstream_consumer>\nOutput consumed by /gsd:execute-phase\nPlans must be executable prompts with:\n- Frontmatter (wave, depends_on, files_modified, autonomous)\n- Tasks in XML format\n- Verification criteria\n- must_haves for goal-backward verification\n</downstream_consumer>\n\n<quality_gate>\nBefore returning PLANNING COMPLETE:\n- [ ] PLAN.md files created in phase directory\n- [ ] Each plan has valid frontmatter\n- [ ] Tasks are specific and actionable\n- [ ] Dependencies correctly identified\n- [ ] Waves assigned for parallel execution\n- [ ] must_haves derived from phase goal\n</quality_gate>\n```\n\n---\n\n## Placeholders\n\n| Placeholder | Source | Example |\n|-------------|--------|---------|\n| `{phase_number}` | From roadmap/arguments | `5` or `2.1` |\n| `{phase_dir}` | Phase directory name | `05-user-profiles` |\n| `{phase}` | Phase prefix | `05` |\n| `{standard \\| gap_closure}` | Mode flag | `standard` |\n\n---\n\n## Usage\n\n**From /gsd:plan-phase (standard mode):**\n```python\nTask(\n  prompt=filled_template,\n  subagent_type=\"gsd-planner\",\n  description=\"Plan Phase {phase}\"\n)\n```\n\n**From /gsd:plan-phase --gaps (gap closure mode):**\n```python\nTask(\n  prompt=filled_template,  # with mode: gap_closure\n  subagent_type=\"gsd-planner\",\n  description=\"Plan gaps for Phase {phase}\"\n)\n```\n\n---\n\n## Continuation\n\nFor checkpoints, spawn fresh agent with:\n\n```markdown\n<objective>\nContinue planning for Phase {phase_number}: {phase_name}\n</objective>\n\n<prior_state>\nPhase directory: @.planning/phases/{phase_dir}/\nExisting plans: @.planning/phases/{phase_dir}/*-PLAN.md\n</prior_state>\n\n<checkpoint_response>\n**Type:** {checkpoint_type}\n**Response:** {user_response}\n</checkpoint_response>\n\n<mode>\nContinue: {standard | gap_closure}\n</mode>\n```\n\n---\n\n**Note:** Planning methodology, task breakdown, dependency analysis, wave assignment, TDD detection, and goal-backward derivation are baked into the gsd-planner agent. This template only passes context.\n"
