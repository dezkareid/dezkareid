prompt = "# Coding Conventions Template\n\nTemplate for `.planning/codebase/CONVENTIONS.md` - captures coding style and patterns.\n\n**Purpose:** Document how code is written in this codebase. Prescriptive guide for Claude to match existing style.\n\n---\n\n## File Template\n\n```markdown\n# Coding Conventions\n\n**Analysis Date:** [YYYY-MM-DD]\n\n## Naming Patterns\n\n**Files:**\n- [Pattern: e.g., \"kebab-case for all files\"]\n- [Test files: e.g., \"*.test.ts alongside source\"]\n- [Components: e.g., \"PascalCase.tsx for React components\"]\n\n**Functions:**\n- [Pattern: e.g., \"camelCase for all functions\"]\n- [Async: e.g., \"no special prefix for async functions\"]\n- [Handlers: e.g., \"handleEventName for event handlers\"]\n\n**Variables:**\n- [Pattern: e.g., \"camelCase for variables\"]\n- [Constants: e.g., \"UPPER_SNAKE_CASE for constants\"]\n- [Private: e.g., \"_prefix for private members\" or \"no prefix\"]\n\n**Types:**\n- [Interfaces: e.g., \"PascalCase, no I prefix\"]\n- [Types: e.g., \"PascalCase for type aliases\"]\n- [Enums: e.g., \"PascalCase for enum name, UPPER_CASE for values\"]\n\n## Code Style\n\n**Formatting:**\n- [Tool: e.g., \"Prettier with config in .prettierrc\"]\n- [Line length: e.g., \"100 characters max\"]\n- [Quotes: e.g., \"single quotes for strings\"]\n- [Semicolons: e.g., \"required\" or \"omitted\"]\n\n**Linting:**\n- [Tool: e.g., \"ESLint with eslint.config.js\"]\n- [Rules: e.g., \"extends airbnb-base, no console in production\"]\n- [Run: e.g., \"npm run lint\"]\n\n## Import Organization\n\n**Order:**\n1. [e.g., \"External packages (react, express, etc.)\"]\n2. [e.g., \"Internal modules (@/lib, @/components)\"]\n3. [e.g., \"Relative imports (., ..)\"]\n4. [e.g., \"Type imports (import type {})\"]\n\n**Grouping:**\n- [Blank lines: e.g., \"blank line between groups\"]\n- [Sorting: e.g., \"alphabetical within each group\"]\n\n**Path Aliases:**\n- [Aliases used: e.g., \"@/ for src/, @components/ for src/components/\"]\n\n## Error Handling\n\n**Patterns:**\n- [Strategy: e.g., \"throw errors, catch at boundaries\"]\n- [Custom errors: e.g., \"extend Error class, named *Error\"]\n- [Async: e.g., \"use try/catch, no .catch() chains\"]\n\n**Error Types:**\n- [When to throw: e.g., \"invalid input, missing dependencies\"]\n- [When to return: e.g., \"expected failures return Result<T, E>\"]\n- [Logging: e.g., \"log error with context before throwing\"]\n\n## Logging\n\n**Framework:**\n- [Tool: e.g., \"console.log, pino, winston\"]\n- [Levels: e.g., \"debug, info, warn, error\"]\n\n**Patterns:**\n- [Format: e.g., \"structured logging with context object\"]\n- [When: e.g., \"log state transitions, external calls\"]\n- [Where: e.g., \"log at service boundaries, not in utils\"]\n\n## Comments\n\n**When to Comment:**\n- [e.g., \"explain why, not what\"]\n- [e.g., \"document business logic, algorithms, edge cases\"]\n- [e.g., \"avoid obvious comments like // increment counter\"]\n\n**JSDoc/TSDoc:**\n- [Usage: e.g., \"required for public APIs, optional for internal\"]\n- [Format: e.g., \"use @param, @returns, @throws tags\"]\n\n**TODO Comments:**\n- [Pattern: e.g., \"// TODO(username): description\"]\n- [Tracking: e.g., \"link to issue number if available\"]\n\n## Function Design\n\n**Size:**\n- [e.g., \"keep under 50 lines, extract helpers\"]\n\n**Parameters:**\n- [e.g., \"max 3 parameters, use object for more\"]\n- [e.g., \"destructure objects in parameter list\"]\n\n**Return Values:**\n- [e.g., \"explicit returns, no implicit undefined\"]\n- [e.g., \"return early for guard clauses\"]\n\n## Module Design\n\n**Exports:**\n- [e.g., \"named exports preferred, default exports for React components\"]\n- [e.g., \"export from index.ts for public API\"]\n\n**Barrel Files:**\n- [e.g., \"use index.ts to re-export public API\"]\n- [e.g., \"avoid circular dependencies\"]\n\n---\n\n*Convention analysis: [date]*\n*Update when patterns change*\n```\n\n<good_examples>\n```markdown\n# Coding Conventions\n\n**Analysis Date:** 2025-01-20\n\n## Naming Patterns\n\n**Files:**\n- kebab-case for all files (command-handler.ts, user-service.ts)\n- *.test.ts alongside source files\n- index.ts for barrel exports\n\n**Functions:**\n- camelCase for all functions\n- No special prefix for async functions\n- handleEventName for event handlers (handleClick, handleSubmit)\n\n**Variables:**\n- camelCase for variables\n- UPPER_SNAKE_CASE for constants (MAX_RETRIES, API_BASE_URL)\n- No underscore prefix (no private marker in TS)\n\n**Types:**\n- PascalCase for interfaces, no I prefix (User, not IUser)\n- PascalCase for type aliases (UserConfig, ResponseData)\n- PascalCase for enum names, UPPER_CASE for values (Status.PENDING)\n\n## Code Style\n\n**Formatting:**\n- Prettier with .prettierrc\n- 100 character line length\n- Single quotes for strings\n- Semicolons required\n- 2 space indentation\n\n**Linting:**\n- ESLint with eslint.config.js\n- Extends @typescript-eslint/recommended\n- No console.log in production code (use logger)\n- Run: npm run lint\n\n## Import Organization\n\n**Order:**\n1. External packages (react, express, commander)\n2. Internal modules (@/lib, @/services)\n3. Relative imports (./utils, ../types)\n4. Type imports (import type { User })\n\n**Grouping:**\n- Blank line between groups\n- Alphabetical within each group\n- Type imports last within each group\n\n**Path Aliases:**\n- @/ maps to src/\n- No other aliases defined\n\n## Error Handling\n\n**Patterns:**\n- Throw errors, catch at boundaries (route handlers, main functions)\n- Extend Error class for custom errors (ValidationError, NotFoundError)\n- Async functions use try/catch, no .catch() chains\n\n**Error Types:**\n- Throw on invalid input, missing dependencies, invariant violations\n- Log error with context before throwing: logger.error({ err, userId }, 'Failed to process')\n- Include cause in error message: new Error('Failed to X', { cause: originalError })\n\n## Logging\n\n**Framework:**\n- pino logger instance exported from lib/logger.ts\n- Levels: debug, info, warn, error (no trace)\n\n**Patterns:**\n- Structured logging with context: logger.info({ userId, action }, 'User action')\n- Log at service boundaries, not in utility functions\n- Log state transitions, external API calls, errors\n- No console.log in committed code\n\n## Comments\n\n**When to Comment:**\n- Explain why, not what: // Retry 3 times because API has transient failures\n- Document business rules: // Users must verify email within 24 hours\n- Explain non-obvious algorithms or workarounds\n- Avoid obvious comments: // set count to 0\n\n**JSDoc/TSDoc:**\n- Required for public API functions\n- Optional for internal functions if signature is self-explanatory\n- Use @param, @returns, @throws tags\n\n**TODO Comments:**\n- Format: // TODO: description (no username, using git blame)\n- Link to issue if exists: // TODO: Fix race condition (issue #123)\n\n## Function Design\n\n**Size:**\n- Keep under 50 lines\n- Extract helpers for complex logic\n- One level of abstraction per function\n\n**Parameters:**\n- Max 3 parameters\n- Use options object for 4+ parameters: function create(options: CreateOptions)\n- Destructure in parameter list: function process({ id, name }: ProcessParams)\n\n**Return Values:**\n- Explicit return statements\n- Return early for guard clauses\n- Use Result<T, E> type for expected failures\n\n## Module Design\n\n**Exports:**\n- Named exports preferred\n- Default exports only for React components\n- Export public API from index.ts barrel files\n\n**Barrel Files:**\n- index.ts re-exports public API\n- Keep internal helpers private (don't export from index)\n- Avoid circular dependencies (import from specific files if needed)\n\n---\n\n*Convention analysis: 2025-01-20*\n*Update when patterns change*\n```\n</good_examples>\n\n<guidelines>\n**What belongs in CONVENTIONS.md:**\n- Naming patterns observed in the codebase\n- Formatting rules (Prettier config, linting rules)\n- Import organization patterns\n- Error handling strategy\n- Logging approach\n- Comment conventions\n- Function and module design patterns\n\n**What does NOT belong here:**\n- Architecture decisions (that's ARCHITECTURE.md)\n- Technology choices (that's STACK.md)\n- Test patterns (that's TESTING.md)\n- File organization (that's STRUCTURE.md)\n\n**When filling this template:**\n- Check .prettierrc, .eslintrc, or similar config files\n- Examine 5-10 representative source files for patterns\n- Look for consistency: if 80%+ follows a pattern, document it\n- Be prescriptive: \"Use X\" not \"Sometimes Y is used\"\n- Note deviations: \"Legacy code uses Y, new code should use X\"\n- Keep under ~150 lines total\n\n**Useful for phase planning when:**\n- Writing new code (match existing style)\n- Adding features (follow naming patterns)\n- Refactoring (apply consistent conventions)\n- Code review (check against documented patterns)\n- Onboarding (understand style expectations)\n\n**Analysis approach:**\n- Scan src/ directory for file naming patterns\n- Check package.json scripts for lint/format commands\n- Read 5-10 files to identify function naming, error handling\n- Look for config files (.prettierrc, eslint.config.js)\n- Note patterns in imports, comments, function signatures\n</guidelines>\n"
