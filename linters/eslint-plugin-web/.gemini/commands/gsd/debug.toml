description = "Systematic debugging with persistent state across context resets"
prompt = "<objective>\nDebug issues using scientific method with subagent isolation.\n\n**Orchestrator role:** Gather symptoms, spawn gsd-debugger agent, handle checkpoints, spawn continuations.\n\n**Why subagent:** Investigation burns context fast (reading files, forming hypotheses, testing). Fresh 200k context per investigation. Main context stays lean for user interaction.\n</objective>\n\n<context>\nUser's issue: $ARGUMENTS\n\nCheck for active sessions:\n```bash\nls .planning/debug/*.md 2>/dev/null | grep -v resolved | head -5\n```\n</context>\n\n<process>\n\n## 0. Initialize Context\n\n```bash\nINIT=$(node ./.gemini/get-shit-done/bin/gsd-tools.js state load)\n```\n\nExtract `commit_docs` from init JSON. Resolve debugger model:\n```bash\nDEBUGGER_MODEL=$(node ./.gemini/get-shit-done/bin/gsd-tools.js resolve-model gsd-debugger --raw)\n```\n\n## 1. Check Active Sessions\n\nIf active sessions exist AND no $ARGUMENTS:\n- List sessions with status, hypothesis, next action\n- User picks number to resume OR describes new issue\n\nIf $ARGUMENTS provided OR user describes new issue:\n- Continue to symptom gathering\n\n## 2. Gather Symptoms (if new issue)\n\nUse AskUserQuestion for each:\n\n1. **Expected behavior** - What should happen?\n2. **Actual behavior** - What happens instead?\n3. **Error messages** - Any errors? (paste or describe)\n4. **Timeline** - When did this start? Ever worked?\n5. **Reproduction** - How do you trigger it?\n\nAfter all gathered, confirm ready to investigate.\n\n## 3. Spawn gsd-debugger Agent\n\nFill prompt and spawn:\n\n```markdown\n<objective>\nInvestigate issue: {slug}\n\n**Summary:** {trigger}\n</objective>\n\n<symptoms>\nexpected: {expected}\nactual: {actual}\nerrors: {errors}\nreproduction: {reproduction}\ntimeline: {timeline}\n</symptoms>\n\n<mode>\nsymptoms_prefilled: true\ngoal: find_and_fix\n</mode>\n\n<debug_file>\nCreate: .planning/debug/{slug}.md\n</debug_file>\n```\n\n```\nTask(\n  prompt=filled_prompt,\n  subagent_type=\"gsd-debugger\",\n  model=\"{debugger_model}\",\n  description=\"Debug {slug}\"\n)\n```\n\n## 4. Handle Agent Return\n\n**If `## ROOT CAUSE FOUND`:**\n- Display root cause and evidence summary\n- Offer options:\n  - \"Fix now\" - spawn fix subagent\n  - \"Plan fix\" - suggest /gsd:plan-phase --gaps\n  - \"Manual fix\" - done\n\n**If `## CHECKPOINT REACHED`:**\n- Present checkpoint details to user\n- Get user response\n- Spawn continuation agent (see step 5)\n\n**If `## INVESTIGATION INCONCLUSIVE`:**\n- Show what was checked and eliminated\n- Offer options:\n  - \"Continue investigating\" - spawn new agent with additional context\n  - \"Manual investigation\" - done\n  - \"Add more context\" - gather more symptoms, spawn again\n\n## 5. Spawn Continuation Agent (After Checkpoint)\n\nWhen user responds to checkpoint, spawn fresh agent:\n\n```markdown\n<objective>\nContinue debugging {slug}. Evidence is in the debug file.\n</objective>\n\n<prior_state>\nDebug file: @.planning/debug/{slug}.md\n</prior_state>\n\n<checkpoint_response>\n**Type:** {checkpoint_type}\n**Response:** {user_response}\n</checkpoint_response>\n\n<mode>\ngoal: find_and_fix\n</mode>\n```\n\n```\nTask(\n  prompt=continuation_prompt,\n  subagent_type=\"gsd-debugger\",\n  model=\"{debugger_model}\",\n  description=\"Continue debug {slug}\"\n)\n```\n\n</process>\n\n<success_criteria>\n- [ ] Active sessions checked\n- [ ] Symptoms gathered (if new)\n- [ ] gsd-debugger spawned with context\n- [ ] Checkpoints handled correctly\n- [ ] Root cause confirmed before fixing\n</success_criteria>"
